# ğŸš€ HÆ°á»›ng dáº«n cÃ i Ä‘áº·t vÃ  thiáº¿t láº­p Backend LearnTwinChain

Há»‡ thá»‘ng Digital Twin cho giÃ¡o dá»¥c, tÃ­ch há»£p blockchain, AI vÃ  zero-knowledge proofs Ä‘á»ƒ theo dÃµi vÃ  quáº£n lÃ½ quÃ¡ trÃ¬nh há»c táº­p.

## ğŸ“‹ YÃªu cáº§u há»‡ thá»‘ng

### Pháº§n má»m cáº§n thiáº¿t:
- **Python 3.9+** (khuyáº¿n nghá»‹ 3.11)
- **Node.js 18+** vÃ  npm
- **Docker & Docker Compose** (cho cÃ¡c dá»‹ch vá»¥ cÆ¡ sá»Ÿ dá»¯ liá»‡u)
- **Git**

### TÃ i khoáº£n bÃªn ngoÃ i cáº§n thiáº¿t:
- **MongoDB Atlas** (hoáº·c MongoDB local)
- **Google Gemini API** (cho AI Tutor)
- **Zilliz Cloud/Milvus** (cho RAG system)
- **Pinata/Web3.Storage** (cho IPFS)
- **Alchemy/Infura** (cho blockchain RPC)
- **Gmail/SMTP** (cho email service)

## ğŸ› ï¸ CÃ i Ä‘áº·t tá»«ng bÆ°á»›c

### CÃ¡ch 1: Quick Setup (Khuyáº¿n nghá»‹)
```bash
git clone <repository-url>
cd learn-twin-chain/backend
python quick_setup.py
```

### CÃ¡ch 2: Manual Setup

### 1. Clone repository vÃ  chuáº©n bá»‹
```bash
git clone <repository-url>
cd learn-twin-chain/backend
```

### 2. CÃ i Ä‘áº·t Python dependencies

#### Táº¡o mÃ´i trÆ°á»ng áº£o (khuyáº¿n nghá»‹):
```bash
# Windows
python -m venv venv
venv\Scripts\activate

# Linux/Mac
python3 -m venv venv
source venv/bin/activate
```

#### CÃ i Ä‘áº·t packages:
```bash
pip install --upgrade pip
pip install -r requirements.txt
```

### 3. CÃ i Ä‘áº·t Node.js dependencies (cho blockchain/circuits)
```bash
npm install
```

### 4. CÃ i Ä‘áº·t Hardhat dependencies (cho smart contracts)
```bash
npx hardhat compile
```

### 5. Thiáº¿t láº­p cÆ¡ sá»Ÿ dá»¯ liá»‡u

#### CÃ¡ch 1: Sá»­ dá»¥ng Docker (Khuyáº¿n nghá»‹ cho development)
```bash
# Khá»Ÿi Ä‘á»™ng MongoDB vÃ  Redis
docker-compose up -d mongodb redis

# Kiá»ƒm tra services Ä‘ang cháº¡y
docker ps
```

#### CÃ¡ch 2: CÃ i Ä‘áº·t thá»§ cÃ´ng
- **MongoDB**: Táº£i tá»« https://www.mongodb.com/try/download/community
- **Redis**: Táº£i tá»« https://redis.io/downloads

### 6. Thiáº¿t láº­p cÃ¡c dá»‹ch vá»¥ IPFS (tÃ¹y chá»n)
```bash
# Khá»Ÿi Ä‘á»™ng IPFS node local (tÃ¹y chá»n)
docker-compose up -d ipfs
```

## âš™ï¸ Cáº¥u hÃ¬nh Environment Variables

### 1. Táº¡o file .env tá»« template:
```bash
cp env.example .env
# Hoáº·c tá»« config folder
cp config/env.example .env
```

### 2. Äiá»n thÃ´ng tin vÃ o .env:

#### **Database Configuration**
```env
MONGODB_URI=mongodb://localhost:27017/learntwinchain
REDIS_URL=redis://localhost:6379/0
```

#### **JWT & Security**
```env
JWT_SECRET_KEY=your_jwt_secret_key_here
SESSION_SECRET_KEY=your_session_secret_key_here
```

#### **Email Service** (Gmail example)
```env
MAIL_USERNAME=your_email@gmail.com
MAIL_PASSWORD=your_app_password
MAIL_FROM=your_email@gmail.com
```

#### **AI Services**
```env
# Google Gemini API
GEMINI_API_KEY=your_gemini_api_key

# Milvus/Zilliz Cloud (cho RAG)
MILVUS_URI=your_milvus_uri
MILVUS_USER=your_username
MILVUS_PASSWORD=your_password
```

#### **Blockchain Configuration**
```env
BLOCKCHAIN_RPC_URL=https://polygon-amoy.g.alchemy.com/v2/your_key
BLOCKCHAIN_PRIVATE_KEY=your_private_key_without_0x
```

#### **IPFS Configuration**
```env
PINATA_API_KEY=your_pinata_api_key
PINATA_SECRET_API_KEY=your_pinata_secret_key
```


## ğŸ”§ Thiáº¿t láº­p cÃ¡c dá»‹ch vá»¥

### 1. Thiáº¿t láº­p MongoDB
- Táº¡o database `learntwinchain`
- Collections sáº½ Ä‘Æ°á»£c táº¡o tá»± Ä‘á»™ng khi cháº¡y application

### 2. Thiáº¿t láº­p Redis
- Cáº¥u hÃ¬nh cho session management vÃ  nonce storage
- Port máº·c Ä‘á»‹nh: 6379

### 3. Thiáº¿t láº­p Gemini AI
1. Truy cáº­p [Google AI Studio](https://aistudio.google.com/)
2. Táº¡o API key
3. ThÃªm vÃ o .env file

### 4. Thiáº¿t láº­p Milvus/Zilliz (cho RAG system)
1. Táº¡o tÃ i khoáº£n táº¡i [Zilliz Cloud](https://cloud.zilliz.com/)
2. Táº¡o cluster
3. Láº¥y URI, username, password

### 5. Thiáº¿t láº­p Pinata (IPFS)
1. Táº¡o tÃ i khoáº£n táº¡i [Pinata](https://pinata.cloud/)
2. Táº¡o API keys
3. ThÃªm vÃ o .env file

### 6. Thiáº¿t láº­p Blockchain
1. Táº¡o tÃ i khoáº£n Alchemy/Infura
2. Táº¡o app cho Polygon Amoy testnet
3. Táº¡o wallet vÃ  láº¥y private key
4. Láº¥y testnet tokens tá»« faucet

## ğŸ—ï¸ Deploy Smart Contracts

### 1. Compile contracts:
```bash
npx hardhat compile
```

### 2. Deploy to testnet:
```bash
python scripts/deploy_contracts.py
```

### 3. Copy contract addresses:
```bash
python scripts/copy_abi.py
```

## ğŸ“ Upload Documents cho RAG (tÃ¹y chá»n)

### 1. Táº¡o sample documents:
```bash
python rag/create_sample_docs.py
```

### 2. Upload documents:
```bash
python rag/upload_docs.py
```

## ğŸš€ Cháº¡y á»©ng dá»¥ng

### 1. Kiá»ƒm tra mÃ´i trÆ°á»ng:
```bash
python check_env.py
```

### 2. Khá»Ÿi Ä‘á»™ng backend:
```bash
python start_backend.py
```

Hoáº·c cháº¡y trá»±c tiáº¿p:
```bash
cd digital_twin
python -m uvicorn main:app --host 0.0.0.0 --port 8000 --reload
```

### 3. Kiá»ƒm tra services:
- **API Documentation**: http://localhost:8000/docs
- **Health Check**: http://localhost:8000/api/v1/health
- **MongoDB**: mongodb://localhost:27017
- **Redis**: redis://localhost:6379

## ğŸ§ª Testing

### 1. Test Redis connection:
```bash
python test/test_redis.py
```

### 2. Test blockchain:
```bash
python test/test_blockchain.py
```

### 3. Test digital twin:
```bash
python test/test_digital_twin.py
```

### 4. Test ZKP circuits:
```bash
python test/test_zkp.py
```

## ğŸ” Troubleshooting

### Lá»—i thÆ°á»ng gáº·p:

#### 1. MongoDB connection failed
```bash
# Kiá»ƒm tra MongoDB Ä‘ang cháº¡y
docker ps | grep mongo
# Hoáº·c
systemctl status mongod
```

#### 2. Redis connection failed
```bash
# Kiá»ƒm tra Redis Ä‘ang cháº¡y
docker ps | grep redis
redis-cli ping
```

#### 3. Gemini API khÃ´ng hoáº¡t Ä‘á»™ng
- Kiá»ƒm tra API key Ä‘Ãºng format
- Kiá»ƒm tra quota vÃ  billing

#### 4. Milvus connection failed
- Kiá»ƒm tra URI, username, password
- Kiá»ƒm tra network connection

#### 5. Blockchain connection failed
- Kiá»ƒm tra RPC URL
- Kiá»ƒm tra private key format (khÃ´ng cÃ³ 0x prefix)
- Kiá»ƒm tra balance wallet

#### 6. Import errors
```bash
# CÃ i Ä‘áº·t láº¡i dependencies
pip install -r requirements.txt --force-reinstall
```

## ğŸ“Š Monitoring & Logs

### 1. View logs:
```bash
# Backend logs
tail -f logs/digital_twin.log

# Docker logs
docker-compose logs -f
```

### 2. Monitor services:
```bash
# Check all containers
docker ps -a

# Check specific service
docker logs learntwinchain_mongo
```

## ğŸ”„ Development Commands

### Useful commands trong quÃ¡ trÃ¬nh phÃ¡t triá»ƒn:

```bash
# Restart all services
docker-compose restart

# Rebuild containers
docker-compose up --build

# View database
mongo mongodb://localhost:27017/learntwinchain

# Connect to Redis
redis-cli

# Check Python dependencies
pip list

# Update requirements
pip freeze > requirements.txt

# Run specific tests
python -m pytest test/test_specific.py -v

# Generate circuits
python scripts/generate_circuits.py

# Migrate data
python scripts/migrate_courses_to_ipfs.py
```

## ğŸ“š Architecture Overview

```
LearnTwinChain Backend
â”œâ”€â”€ ğŸŒ FastAPI Application (Port 8000)
â”œâ”€â”€ ğŸ“Š MongoDB (Database)
â”œâ”€â”€ ğŸ’¾ Redis (Session & Cache)
â”œâ”€â”€ ğŸ§  Milvus (Vector Database for RAG)
â”œâ”€â”€ ğŸ¤– Gemini AI (Conversational AI)
â”œâ”€â”€ ğŸ”— Blockchain (Smart Contracts)
â”œâ”€â”€ ğŸ“ IPFS (Decentralized Storage)
â””â”€â”€ ğŸ” ZK Circuits (Privacy-Preserving Proofs)
```

## ğŸ¯ CÃ¡c tÃ­nh nÄƒng chÃ­nh

- âœ… **Digital Twin Management**: Theo dÃµi há»c táº­p cÃ¡ nhÃ¢n hÃ³a
- âœ… **Blockchain Integration**: NFT cho thÃ nh tÃ­ch vÃ  tiáº¿n Ä‘á»™
- âœ… **AI Tutor**: Há»— trá»£ há»c táº­p thÃ´ng minh
- âœ… **RAG System**: TÃ¬m kiáº¿m vÃ  tráº£ lá»i cÃ¢u há»i tá»« tÃ i liá»‡u
- âœ… **Zero-Knowledge Proofs**: Báº£o máº­t thÃ´ng tin há»c táº­p
- âœ… **IPFS Storage**: LÆ°u trá»¯ phi táº­p trung
- âœ… **Email Integration**: ThÃ´ng bÃ¡o vÃ  xÃ¡c thá»±c
- âœ… **Session Management**: ÄÄƒng nháº­p an toÃ n

